
# 同源策略

同源指的是在url中 **协议、域名、端口号** 均[相同]。
同源策略是浏览器的一个安全功能，不同源的脚本在没有明确授权的情况下，不能读写对方资源。
本域下面的js不能调用其他域的js,对象或数据,能操作其他域的页面对象。
安全限制的同时也给注入iframe或是ajax应用上带来了不少麻烦。

# jsonp

jsonp 全称是JSON with Padding,非官方跨域方法。

因为通过script标签引入的js是不受同源策略的限制的，所以我们可以通过script标签引入一个js或者是一个其他后缀形式（如php，jsp等）的文件，此文件返回一个js函数的调用，如返回JSONP_getUsers(["paco","john","lili"])，也就是说此文件返回的结果调用了JSONP_getUsers函数，并且把["paco","john","lili"]传进去，这个["paco","john","lili"]是一个用户列表。那么如果此时我们的页面中有一个JSONP_getUsers函数，那么JSONP_getUsers就被调用到，并且传入了用户列表。此时就实现了在本域获取其他域数据的功能，也就是跨域。
为什么script标签引入的文件不受同源策略的限制？因为script标签引入的文件内容是不能够被客户端的js获取到的，不会影响到被引用文件的安全，所以没必要使script标签引入的文件遵循浏览器的同源策略。而通过ajax加载的文件内容是能够被客户端js获取到的，所以ajax必须遵循同源策略，否则被引入文件的内容会泄漏或者存在其他风险。

JSONP的缺点则是：它只支持GET请求 而不支持POST等其它类型的HTTP请求（虽然采用post+动态生成iframe是可以达到post跨域的目的，但这样做是一个比较极端的方式，不建议采用）。一般get请求能完成所有功能。比如如果需要给其他域服务器传送参数可以在请求后挂参数（注意不要挂隐私数据）

JSONP易于实现，但是也会存在一些安全隐患，如果第三方的脚本随意地执行，那么它就可以篡改页面内容，截获敏感数据。但是在受信任的双方传递数据，JSONP是非常合适的选择。可以看出来JSONP跨域一般用于获取其他域的数据。

1、浏览器跨域向服务器请求数据，并传回调函数名给服务器
2、服务器生成调用该回调函数的js代码，将数据作为回调函数的参数传入。将这段代码返回给客户端
3、浏览器执行服务器返回的js代码，即调用回调函数
综上：用jsonp跨域请求数据需要服务器支持
